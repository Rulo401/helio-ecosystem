{
    "builder": "RmlUnitBuilder",
    "description": "## Theory\r\nRML mapping allows you to link subjects from two different ***TripleMaps*** regardless of the source of the data. In this case we use a different structure for the objectMap. This time the ***rr:objectMap*** has exactly one ***rr:parentTiplesMap*** property (indicating the map to link to) and at least one ***rr:joinCondition*** property (specifying the data that must match in both data sources).\r\n\r\nThe ***rr:joinCondition*** has two properties: ***rr:child*** and ***rr:parent***. Both are a logical reference into the logical source (columns of a CSV in this case). The first one refers to the ***rml:logicalSource*** of the current map and the second to the ***rml:logicalSource***  of the parent map.\r\n\r\nFor example:\r\n```\r\n<#TriplesMap2> rr:predicateObjectMap [\r\n\t\trr:predicate example:predicate;\r\n\t\trr:objectMap [\r\n\t\t\trr:parentTriplesMap <#TriplesMap1>;\r\n\t\t\trr:joinCondition [\r\n\t\t\t\trr:child \"MAP2_CSV_COLUMN_NAME\";  rr:parent \"MAP1_CSV_COLUMN_NAME\";\r\n\t\t\t];\r\n\t\t]\r\n\t] .\r\n```\r\n## Hands-on\r\n### Task\r\nNotice that both CSVs have a column with values in common (City and CName); when and if the values from these columns are the same, then the corresponding object property is generated among the subjects of the different TriplesMap.\r\nFill in the mapping below to compare these columns and link the subjects from **<#TriplesMap2>** to **<#TriplesMap1>** using the predicate **foaf:based_near**.\r\n### CSV file content\r\n#### Locations\r\nCName,latitude,longitude\r\nOneonta,\"44.9625428\",\"-74.4168577\"\r\nIowa,\"29.6862705\",\"-82.319746\"\r\nAlberta,\"41.0816094\",\"-76.4098259\"\r\nBock,\"41.6908535\",\"-85.9562663\"\r\nElmhurst,\"31.4199205\",\"-109.9103821\"\r\n<!---\r\nReplace table when Markdown works properly\r\n| CName | latitude | longitude |\r\n|----|----|----|----|\r\n| Oneonta | \"44.9625428\" | \"-74.4168577\" |\r\n| Iowa | \"29.6862705\" | \"-82.319746\" |\r\n| Alberta | \"41.0816094\" | \"-76.4098259\" |\r\n| Bock | \"41.6908535\" | \"-85.9562663\" | \r\n| Elmhurst | \"31.4199205\" | \"-109.9103821\" |\r\n--->\r\n#### People\r\nID,Name,Phone,City\r\n1,\"Lily Dickens\",585-610-2352,Oneonta\r\n2,\"Chadd Sporer\",+1-352-334-0992,Iowa\r\n3,\"Katharina Kuvalis\",(272) 642-0684,Alberta\r\n4,\"Wilhelmine Johns III\",574.747.4829,Bock\r\n5,\"Sofia Rowe\",+15204328362,Elmhurst\r\n<!---\r\nReplace table when Markdown works properly\r\n| ID | Name | Phone | City |\r\n|--|--|--|--|\r\n| 1 | \"Lily Dickens\" | 585-610-2352 | Oneonta |\r\n| 2 | \"Chadd Sporer\" | +1-352-334-0992 | Iowa |\r\n| 3 | \"Katharina Kuvalis\" | (272) 642-0684 | Alberta |\r\n| 4 | \"Wilhelmine Johns III\" | 574.747.4829 | Bock |\r\n| 5 | \"Sofia Rowe\" | +15204328362 | Elmhurst |\r\n--->",
    "user_template": "@prefix rr: <http:\/\/www.w3.org\/ns\/r2rml#> .\r\n@prefix rml: <http:\/\/semweb.mmlab.be\/ns\/rml#> .\r\n@prefix ql: <http:\/\/semweb.mmlab.be\/ns\/ql#> .\r\n@prefix transit: <http:\/\/vocab.org\/transit\/terms\/> .\r\n@prefix xsd: <http:\/\/www.w3.org\/2001\/XMLSchema#> .\r\n@prefix foaf: <http:\/\/xmlns.com\/foaf\/0.1\/> .\r\n@prefix sch: <http:\/\/schema.org\/> .\r\n@base <http:\/\/example.com\/ns#> .\r\n\r\n# First TriplesMap about locations\r\n<#TriplesMap1> rml:logicalSource [\r\n\t\t\trml:source \"https:\/\/raw.githubusercontent.com\/helio-ecosystem\/helio-ecosystem\/main\/resources\/mappings-data\/ldac\/locations.csv\" ;\r\n\t\t\trml:referenceFormulation ql:CSV\r\n\t\t] ;\r\n\t\trr:subjectMap [\r\n\t\t\trr:template \"http:\/\/sample.com\/resource\/{CName}\" ;\r\n\t\t\trr:termType rr:IRI ;\r\n\t\t] ;\r\n\t\trr:predicateObjectMap [\r\n\t\t\trr:predicate  foaf:name ;\r\n\t\t\trr:objectMap [ rml:reference \"CName\" ; rr:termType rr:Literal ; ]\r\n\t\t] .\r\n\r\n\r\n# Second TriplesMap about people\r\n<#TriplesMap2> rml:logicalSource [\r\n\t\t\trml:source \"https:\/\/raw.githubusercontent.com\/helio-ecosystem\/helio-ecosystem\/main\/resources\/mappings-data\/ldac\/people.csv\" ;\r\n\t\t\trml:referenceFormulation ql:CSV\r\n\t\t] ;\r\n\t\trr:subjectMap [\r\n\t\t\trr:termType rr:IRI ;\r\n\t\t\trr:template \"http:\/\/sample.com\/resource\/P{ID}\" ;\r\n\t\t\trr:class foaf:Person\r\n\t\t] ;\r\n\t\trr:predicateObjectMap [\r\n\t\t\trr:predicate  foaf:name ;\r\n\t\t\trr:objectMap [\r\n\t\t\t\trml:reference \"Name\"; rr:termType rr:Literal ;\r\n\t\t\t\trr:datatype xsd:string\r\n\t\t\t]\r\n\t\t] ;\r\n\t\trr:predicateObjectMap [\r\n\t\t\trr:predicate #OBJECTPROPERTY_PREDICATE ;\r\n\t\t\trr:objectMap [\r\n\t\t\t\trr:parentTriplesMap # WRITE HERE REFERENCE TO MAP ONE ;\r\n\t\t\t\trr:joinCondition [\r\n\t\t\t\t\trr:child # WRITE HERE DATAPROPERTY_FROM_TRIPLE_MAP2 ;  rr:parent #WRITE HERE DATAPROPERTY_FROM_TRIPLE_MAP1 ;\r\n\t\t\t] ;\r\n\t\t]\r\n\t] .",
    "solution_template": "@prefix rr: <http:\/\/www.w3.org\/ns\/r2rml#> .\r\n@prefix rml: <http:\/\/semweb.mmlab.be\/ns\/rml#> .\r\n@prefix ql: <http:\/\/semweb.mmlab.be\/ns\/ql#> .\r\n@prefix transit: <http:\/\/vocab.org\/transit\/terms\/> .\r\n@prefix xsd: <http:\/\/www.w3.org\/2001\/XMLSchema#> .\r\n@prefix foaf: <http:\/\/xmlns.com\/foaf\/0.1\/> .\r\n@prefix sch: <http:\/\/schema.org\/> .\r\n@base <http:\/\/example.com\/ns#> .\r\n\r\n# First TriplesMap about locations\r\n<#TriplesMap1> rml:logicalSource [\r\n\t\t\trml:source \"https:\/\/raw.githubusercontent.com\/helio-ecosystem\/helio-ecosystem\/main\/resources\/mappings-data\/ldac\/locations.csv\" ;\r\n\t\t\trml:referenceFormulation ql:CSV\r\n\t\t] ;\r\n\t\trr:subjectMap [\r\n\t\t\trr:template \"http:\/\/sample.com\/resource\/{CName}\" ;\r\n\t\t\trr:termType rr:IRI ;\r\n\t\t] ;\r\n\t\trr:predicateObjectMap [\r\n\t\t\trr:predicate  foaf:name ;\r\n\t\t\trr:objectMap [ rml:reference \"CName\" ; rr:termType rr:Literal ; ]\r\n\t\t] .\r\n\r\n\r\n# Second TriplesMap about people\r\n<#TriplesMap2> rml:logicalSource [\r\n\t\t\trml:source \"https:\/\/raw.githubusercontent.com\/helio-ecosystem\/helio-ecosystem\/main\/resources\/mappings-data\/ldac\/people.csv\" ;\r\n\t\t\trml:referenceFormulation ql:CSV\r\n\t\t] ;\r\n\t\trr:subjectMap [\r\n\t\t\trr:termType rr:IRI ;\r\n\t\t\trr:template \"http:\/\/sample.com\/resource\/P{ID}\" ;\r\n\t\t\trr:class foaf:Person\r\n\t\t] ;\r\n\t\trr:predicateObjectMap [\r\n\t\t\trr:predicate  foaf:name ;\r\n\t\t\trr:objectMap [\r\n\t\t\t\trml:reference \"Name\"; rr:termType rr:Literal ;\r\n\t\t\t\trr:datatype xsd:string\r\n\t\t\t]\r\n\t\t] ;\r\n\t\trr:predicateObjectMap [\r\n\t\t\trr:predicate foaf:based_near ;\r\n\t\t\trr:objectMap [ \r\n\t\t\t\trr:parentTriplesMap <#TriplesMap1> ;\r\n\t\t\t\trr:joinCondition [\r\n\t\t\t\t\trr:child \"City\" ;  rr:parent \"CName\" ;\r\n\t\t\t] ;\r\n\t\t]\r\n\t] .",
    "expected_result": "<http://sample.com/resource/Alberta> <http://xmlns.com/foaf/0.1/name> \"Alberta\" .\n\n<http://sample.com/resource/Bock> <http://xmlns.com/foaf/0.1/name> \"Bock\" .\n\n<http://sample.com/resource/Elmhurst> <http://xmlns.com/foaf/0.1/name> \"Elmhurst\" .\n\n<http://sample.com/resource/Iowa> <http://xmlns.com/foaf/0.1/name> \"Iowa\" .\n\n<http://sample.com/resource/Oneonta> <http://xmlns.com/foaf/0.1/name> \"Oneonta\" .\n\n<http://sample.com/resource/P1> a <http://xmlns.com/foaf/0.1/Person>;\n  <http://xmlns.com/foaf/0.1/based_near> <http://sample.com/resource/Oneonta>;\n  <http://xmlns.com/foaf/0.1/name> \"Lily Dickens\" .\n\n<http://sample.com/resource/P2> a <http://xmlns.com/foaf/0.1/Person>;\n  <http://xmlns.com/foaf/0.1/based_near> <http://sample.com/resource/Iowa>;\n  <http://xmlns.com/foaf/0.1/name> \"Chadd Sporer\" .\n\n<http://sample.com/resource/P3> a <http://xmlns.com/foaf/0.1/Person>;\n  <http://xmlns.com/foaf/0.1/based_near> <http://sample.com/resource/Alberta>;\n  <http://xmlns.com/foaf/0.1/name> \"Katharina Kuvalis\" .\n\n<http://sample.com/resource/P4> a <http://xmlns.com/foaf/0.1/Person>;\n  <http://xmlns.com/foaf/0.1/based_near> <http://sample.com/resource/Bock>;\n  <http://xmlns.com/foaf/0.1/name> \"Wilhelmine Johns III\" .\n\n<http://sample.com/resource/P5> a <http://xmlns.com/foaf/0.1/Person>;\n  <http://xmlns.com/foaf/0.1/based_near> <http://sample.com/resource/Elmhurst>;\n  <http://xmlns.com/foaf/0.1/name> \"Sofia Rowe\" ."
}
