{
     "builder": "SIoTRxBuilder",
    "description": "## GeoSPARQL\n### This mapping shows how to find the distance between two geographical points. The mapping uses the [SparqlEngine action](https://github.com/helio-ecosystem/helio-action-sparql-engine) that implements the [geo sparql features provided by jena](https://jena.apache.org/documentation/geosparql/index.html)",
    "user_template": "<#-- RDF data --> \r\n<#assign rdf>\r\n@prefix geo: <http:\/\/www.w3.org\/2003\/01\/geo\/wgs84_pos#> .\r\n\r\n<http:\/\/example.com\/ObservationValues\/GasCO\/1450439142>\r\n  a <http:\/\/purl.oclc.org\/NET\/ssnx\/ssn#ObservationValue> ;\r\n  geo:location <http:\/\/example.com\/locations\/GasCO\/1450439142> .\r\n\r\n<http:\/\/example.com\/locations\/GasCO\/1450439142>\r\n  geo:lat \"35.4\" ;\r\n  geo:long \"32\" .\r\n<\/#assign>\r\n\r\n\r\n<#-- Querying RDF data -->\r\n<#-- More info abour supported geo features at https:\/\/jena.apache.org\/documentation\/geosparql\/index.html -->\r\n<#assign query>\r\n  PREFIX rdfs: <http:\/\/www.w3.org\/2000\/01\/rdf-schema#>  \r\n\t\tPREFIX wgs: <http:\/\/www.w3.org\/2003\/01\/geo\/wgs84_pos#>  \r\n\t\tPREFIX xsd: <http:\/\/www.w3.org\/2001\/XMLSchema#>  \r\n\t\tPREFIX ssn: <http:\/\/purl.oclc.org\/NET\/ssnx\/ssn#>  \r\n    PREFIX spatialF: <http:\/\/jena.apache.org\/function\/spatial#> \r\n    PREFIX units: <http:\/\/www.opengis.net\/def\/uom\/OGC\/1.0\/>\r\n\t\tSELECT ?point ?point2 ?distance WHERE {\r\n\t\t  ?subj wgs:lat ?lat .\r\n  \t ?subj wgs:long ?lon .\r\n  \t BIND(spatialF:convertLatLon(?lat, ?lon) as ?point) . \r\n  \t BIND(spatialF:convertLatLon(32, 35.5) as ?point2) .\r\n     BIND( spatialF:distance(?point, ?point2, units:kilometer) as ?distance) . \r\n}\r\n<\/#assign>\r\n\r\n<#assign config = '{\"query\" : \"'+query+'\", \"data-forma\" : \"rdf\/xml\" }'>\r\n<@action type=\"SparqlEngine\" data=rdf conf=config; result>\r\n[=result]\r\n<\/@action>\r\n",
    "solution_template": "<#-- RDF data --> \r\n<#assign rdf>\r\n@prefix geo: <http:\/\/www.w3.org\/2003\/01\/geo\/wgs84_pos#> .\r\n\r\n<http:\/\/example.com\/ObservationValues\/GasCO\/1450439142>\r\n  a <http:\/\/purl.oclc.org\/NET\/ssnx\/ssn#ObservationValue> ;\r\n  geo:location <http:\/\/example.com\/locations\/GasCO\/1450439142> .\r\n\r\n<http:\/\/example.com\/locations\/GasCO\/1450439142>\r\n  geo:lat \"35.4\" ;\r\n  geo:long \"32\" .\r\n<\/#assign>\r\n\r\n\r\n<#-- Querying RDF data -->\r\n<#-- More info abour supported geo features at https:\/\/jena.apache.org\/documentation\/geosparql\/index.html -->\r\n<#assign query>\r\n  PREFIX rdfs: <http:\/\/www.w3.org\/2000\/01\/rdf-schema#>  \r\n\t\tPREFIX wgs: <http:\/\/www.w3.org\/2003\/01\/geo\/wgs84_pos#>  \r\n\t\tPREFIX xsd: <http:\/\/www.w3.org\/2001\/XMLSchema#>  \r\n\t\tPREFIX ssn: <http:\/\/purl.oclc.org\/NET\/ssnx\/ssn#>  \r\n    PREFIX spatialF: <http:\/\/jena.apache.org\/function\/spatial#> \r\n    PREFIX units: <http:\/\/www.opengis.net\/def\/uom\/OGC\/1.0\/>\r\n\t\tSELECT ?point ?point2 ?distance WHERE {\r\n\t\t  ?subj wgs:lat ?lat .\r\n  \t ?subj wgs:long ?lon .\r\n  \t BIND(spatialF:convertLatLon(?lat, ?lon) as ?point) . \r\n  \t BIND(spatialF:convertLatLon(32, 35.5) as ?point2) .\r\n     BIND( spatialF:distance(?point, ?point2, units:kilometer) as ?distance) . \r\n}\r\n<\/#assign>\r\n\r\n<#assign config = '{\"query\" : \"'+query+'\", \"data-forma\" : \"rdf\/xml\" }'>\r\n<@action type=\"SparqlEngine\" data=rdf conf=config; result>\r\n[=result]\r\n<\/@action>\r\n",
    "expected_result": "{ \"head\": {    \n    \"vars\": [ \"point\" , \"point2\" , \"distance\" ]    \n  } ,    \n  \"results\": {    \n    \"bindings\": [    \n      {     \n        \"point\": { \"type\": \"literal\" , \"datatype\": \"http:\/\/www.opengis.net\/ont\/geosparql#wktLiteral\" , \"value\": \"<http:\/\/www.opengis.net\/def\/crs\/EPSG\/0\/4326> POINT(35.4 32)\" } ,    \n        \"point2\": { \"type\": \"literal\" , \"datatype\": \"http:\/\/www.opengis.net\/ont\/geosparql#wktLiteral\" , \"value\": \"<http:\/\/www.opengis.net\/def\/crs\/EPSG\/0\/4326> POINT(32 35.5)\" } ,    \n        \"distance\": { \"type\": \"literal\" , \"datatype\": \"http:\/\/www.w3.org\/2001\/XMLSchema#double\" , \"value\": \"497.679509e0\" }    \n      }    \n    ]    \n  }    \n}"
}
