{
     "builder": "SIoTRxBuilder",
    "description": "## MESH entity reconciliation\n### This mapping provides an entity reconciliation service that given a plain string outputs existing entities from [MESH](https://id.nlm.nih.gov/mesh/) that match the string criteria. </br> The mapping invokes and combines different enpoints probivided by the [MESH API](https://id.nlm.nih.gov/mesh/swagger/ui) and returns an aggregated view of the different results provided by the API.",
    "user_template": "<#assign concept = \"tuberculosis miliary\"> <#-- Replace 'tuberculosis miliary' with the name of a new entity -->\r\n<#assign criteria = \"contains\">\r\n\r\n<@request concept criteria; result> \r\n  [=result] <#-- This is the variable been printed with the data of the found entities -->\r\n<\/@request>\r\n\r\n<#-- Macro definition to find the entity in MESH dataset -->\r\n<#macro request conceptRaw criteria>\r\n  <#assign concept = conceptRaw?replace(\" \",\"%20\")>\r\n  <#assign url = \"https:\/\/id.nlm.nih.gov\/mesh\/lookup\/descriptor?label=\"+concept+\"&match=\"+criteria+\"&year=current&limit=10\">\r\n  <#assign config=\"{ \\\"method\\\" : \\\"GET\\\", \\\"url\\\" : \\\"\"+url+\"\\\" }\">\r\n  <#assign descriptors=providers(\"HttpProvider\", config)>\r\n  <#assign url = \"https:\/\/id.nlm.nih.gov\/mesh\/lookup\/term?label=\"+concept+\"&match=\"+criteria+\"&limit=10\">\r\n  <#assign config=\"{ \\\"method\\\" : \\\"GET\\\", \\\"url\\\" : \\\"\"+url+\"\\\" }\">\r\n  <#assign terms=providers(\"HttpProvider\", config)>\r\n  <#assign synonyms = []>\r\n  <#list descriptors?eval as descriptor>\r\n    <#assign id = descriptor.resource?replace('http:\/\/id.nlm.nih.gov\/mesh\/','')>\r\n    <#assign url = \"https:\/\/id.nlm.nih.gov\/mesh\/lookup\/label?resource=\"+id>\r\n    <#assign config=\"{ \\\"method\\\" : \\\"GET\\\", \\\"url\\\" : \\\"\"+url+\"\\\" }\">\r\n    <#assign altNamesTmp= providers(\"HttpProvider\", config)?replace('[','')?replace(']','')>\r\n    <#assign synonyms = synonyms + [ \"\u00A0{ \\\"\"+id+\"\\\" :  [\"+altNamesTmp+\"] }\" ]>\r\n  <\/#list>\r\n <#list terms?eval as term>\r\n    <#assign id = term.resource?replace('http:\/\/id.nlm.nih.gov\/mesh\/','')>\r\n    <#assign url = \"https:\/\/id.nlm.nih.gov\/mesh\/lookup\/label?resource=\"+id>\r\n    <#assign config=\"{ \\\"method\\\" : \\\"GET\\\", \\\"url\\\" : \\\"\"+url+\"\\\" }\">\r\n    <#assign altNamesTmp = providers(\"HttpProvider\", config)?replace('[','')?replace(']','')>\r\n    <#assign synonyms = synonyms + [ \"\u00A0{ \\\"\"+id+\"\\\" :  [\"+altNamesTmp+\"] }\" ]>\r\n  <\/#list>\r\n   \r\n  <#nested \"{\\\"search\\\" : \\\"\"+conceptRaw+\"\\\", \\\"descriptors\\\" : \"+descriptors+\", \\\"terms\\\" : \"+terms+\", \\\"synonyms\\\" : \"+synonyms?join(\", \", \"[]\")+\" }\">\r\n  \r\n<\/#macro>",
    "solution_template": "<#assign concept = \"tuberculosis miliary\"> <#-- Replace 'tuberculosis miliary' with the name of a new entity -->\r\n<#assign criteria = \"contains\">\r\n\r\n<@request concept criteria; result> \r\n  [=result] <#-- This is the variable been printed with the data of the found entities -->\r\n<\/@request>\r\n\r\n<#-- Macro definition to find the entity in MESH dataset -->\r\n<#macro request conceptRaw criteria>\r\n  <#assign concept = conceptRaw?replace(\" \",\"%20\")>\r\n  <#assign url = \"https:\/\/id.nlm.nih.gov\/mesh\/lookup\/descriptor?label=\"+concept+\"&match=\"+criteria+\"&year=current&limit=10\">\r\n  <#assign config=\"{ \\\"method\\\" : \\\"GET\\\", \\\"url\\\" : \\\"\"+url+\"\\\" }\">\r\n  <#assign descriptors=providers(\"HttpProvider\", config)>\r\n  <#assign url = \"https:\/\/id.nlm.nih.gov\/mesh\/lookup\/term?label=\"+concept+\"&match=\"+criteria+\"&limit=10\">\r\n  <#assign config=\"{ \\\"method\\\" : \\\"GET\\\", \\\"url\\\" : \\\"\"+url+\"\\\" }\">\r\n  <#assign terms=providers(\"HttpProvider\", config)>\r\n  <#assign synonyms = []>\r\n  <#list descriptors?eval as descriptor>\r\n    <#assign id = descriptor.resource?replace('http:\/\/id.nlm.nih.gov\/mesh\/','')>\r\n    <#assign url = \"https:\/\/id.nlm.nih.gov\/mesh\/lookup\/label?resource=\"+id>\r\n    <#assign config=\"{ \\\"method\\\" : \\\"GET\\\", \\\"url\\\" : \\\"\"+url+\"\\\" }\">\r\n    <#assign altNamesTmp= providers(\"HttpProvider\", config)?replace('[','')?replace(']','')>\r\n    <#assign synonyms = synonyms + [ \"\u00A0{ \\\"\"+id+\"\\\" :  [\"+altNamesTmp+\"] }\" ]>\r\n  <\/#list>\r\n <#list terms?eval as term>\r\n    <#assign id = term.resource?replace('http:\/\/id.nlm.nih.gov\/mesh\/','')>\r\n    <#assign url = \"https:\/\/id.nlm.nih.gov\/mesh\/lookup\/label?resource=\"+id>\r\n    <#assign config=\"{ \\\"method\\\" : \\\"GET\\\", \\\"url\\\" : \\\"\"+url+\"\\\" }\">\r\n    <#assign altNamesTmp = providers(\"HttpProvider\", config)?replace('[','')?replace(']','')>\r\n    <#assign synonyms = synonyms + [ \"\u00A0{ \\\"\"+id+\"\\\" :  [\"+altNamesTmp+\"] }\" ]>\r\n  <\/#list>\r\n   \r\n  <#nested \"{\\\"search\\\" : \\\"\"+conceptRaw+\"\\\", \\\"descriptors\\\" : \"+descriptors+\", \\\"terms\\\" : \"+terms+\", \\\"synonyms\\\" : \"+synonyms?join(\", \", \"[]\")+\" }\">\r\n  \r\n<\/#macro>",
    "expected_result": "{\"search\" : \"tuberculosis miliary\", \"descriptors\" : [{\"resource\":\"http:\/\/id.nlm.nih.gov\/mesh\/D014391\",\"label\":\"Tuberculosis, Miliary\"}], \"terms\" : [{\"resource\":\"http:\/\/id.nlm.nih.gov\/mesh\/T042085\",\"label\":\"Tuberculosis, Miliary\"}], \"synonyms\" : \u00A0{ \"D014391\" :  [\"Tuberculosis, Miliary\"] }, \u00A0{ \"T042085\" :  [\"Miliary Tuberculoses\",\"Miliary Tuberculosis\",\"Tuberculoses, Miliary\",\"Tuberculosis, Miliary\"] } }"
}
