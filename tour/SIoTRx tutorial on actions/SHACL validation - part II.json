{
  "builder": "SIoTRxBuilder",
  "description": "## SHACL validation part II\n### This mapping shows how to use the [SHACL validator action](https://github.com/helio-ecosystem/helio-action-shacl-validator) for validating some [RDF provided by a remote URL](https://raw.githubusercontent.com/helio-ecosystem/helio-ecosystem/main/resources/siotrx/actions/shacl/sample-dataset.ttl) using a [SHACL shape also provided in a URL](https://raw.githubusercontent.com/helio-ecosystem/helio-ecosystem/main/resources/siotrx/actions/shacl/sample-shacl.ttl). Consider that both the RDF and the shapes can be retrieved as shown in this tutorial or as shown in the [first example](https://helio-playground.linkeddata.es/tour/SIoTRx%20tutorial%20on%20actions/SHACL%20validation%20-%20part%20I), any combination is valid.<br /><br /> Note that either the shape and the data are expressed in `TURTLE`, this is not suitable for any case since the RDF or the shapes could be expressed in any other serialisation. Furthermore, the report is always output in `TURTLE` but sometimes other serialisations are needed. In [SHACL shapes part III](https://helio-playground.linkeddata.es/tour/SIoTRx%20tutorial%20on%20actions/SHACL%20validation%20-%20part%20III) all these topics are covered.",
  "user_template": "<#-- RDF data -->\r\n<#assign rdf=\"https:\/\/raw.githubusercontent.com\/helio-ecosystem\/helio-ecosystem\/main\/resources\/siotrx\/actions\/shacl\/sample-dataset.ttl\">\r\n\r\n<#-- SHACL shape -->\r\n<#assign shape=\"https:\/\/raw.githubusercontent.com\/helio-ecosystem\/helio-ecosystem\/main\/resources\/siotrx\/actions\/shacl\/sample-shacl.ttl\">\r\n\r\n<#-- Running the validation -->\r\n<#assign config=\"{\\\"shape\\\" : \\\"\"+shape+\"\\\" }\">\r\n<@action type=\"ShaclValidator\" data=rdf conf=config; report>\r\n[=report]\r\n<\/@action>",
  "solution_template": "<#-- RDF data -->\r\n<#assign rdf=\"https:\/\/raw.githubusercontent.com\/helio-ecosystem\/helio-ecosystem\/main\/resources\/siotrx\/actions\/shacl\/sample-dataset.ttl\">\r\n\r\n<#-- SHACL shape -->\r\n<#assign shape=\"https:\/\/raw.githubusercontent.com\/helio-ecosystem\/helio-ecosystem\/main\/resources\/siotrx\/actions\/shacl\/sample-shacl.ttl\">\r\n\r\n<#-- Running the validation -->\r\n<#assign config=\"{\\\"shape\\\" : \\\"\"+shape+\"\\\" }\">\r\n<@action type=\"ShaclValidator\" data=rdf conf=config; report>\r\n[=report]\r\n<\/@action>",
  "expected_result": "@prefix ex:   <https:\/\/sample.es\/resources\/> .\r\n@prefix rdf:  <http:\/\/www.w3.org\/1999\/02\/22-rdf-syntax-ns#> .\r\n@prefix rdfs: <http:\/\/www.w3.org\/2000\/01\/rdf-schema#> .\r\n@prefix sh:   <http:\/\/www.w3.org\/ns\/shacl#> .\r\n@prefix xsd:  <http:\/\/www.w3.org\/2001\/XMLSchema#> .\r\n\r\n[ rdf:type     sh:ValidationReport ;\r\n  sh:conforms  false ;\r\n  sh:result    [ rdf:type                      sh:ValidationResult ;\r\n                 sh:focusNode                  ex:Calvin ;\r\n                 sh:resultMessage              \"ClassConstraint[<https:\/\/sample.es\/resources\/Company>]: Expected class :<https:\/\/sample.es\/resources\/Company> for <https:\/\/sample.es\/resources\/UntypedCompany>\" ;\r\n                 sh:resultPath                 ex:worksFor ;\r\n                 sh:resultSeverity             sh:Violation ;\r\n                 sh:sourceConstraintComponent  sh:ClassConstraintComponent ;\r\n                 sh:sourceShape                []  ;\r\n                 sh:value                      ex:UntypedCompany\r\n               ] ;\r\n  sh:result    [ rdf:type                      sh:ValidationResult ;\r\n                 sh:focusNode                  ex:Calvin ;\r\n                 sh:resultMessage              \"Closed[https:\/\/sample.es\/resources\/ssn, https:\/\/sample.es\/resources\/worksFor][http:\/\/www.w3.org\/1999\/02\/22-rdf-syntax-ns#type] Property = <https:\/\/sample.es\/resources\/birthDate> : Object = \\\"1971-07-07\\\"^^xsd:date\" ;\r\n                 sh:resultPath                 ex:birthDate ;\r\n                 sh:resultSeverity             sh:Violation ;\r\n                 sh:sourceConstraintComponent  sh:ClosedConstraintComponent ;\r\n                 sh:sourceShape                ex:PersonShape ;\r\n                 sh:value                      \"1971-07-07\"^^xsd:date\r\n               ] ;\r\n  sh:result    [ rdf:type                      sh:ValidationResult ;\r\n                 sh:focusNode                  ex:Alice ;\r\n                 sh:resultMessage              \"Pattern[^\\\\d{3}-\\\\d{2}-\\\\d{4}$]: Does not match: '987-65-432A'\" ;\r\n                 sh:resultPath                 ex:ssn ;\r\n                 sh:resultSeverity             sh:Violation ;\r\n                 sh:sourceConstraintComponent  sh:PatternConstraintComponent ;\r\n                 sh:sourceShape                _:b0 ;\r\n                 sh:value                      \"987-65-432A\"\r\n               ] ;\r\n  sh:result    [ rdf:type                      sh:ValidationResult ;\r\n                 sh:focusNode                  ex:Bob ;\r\n                 sh:resultMessage              \"maxCount[1]: Invalid cardinality: expected max 1: Got count = 2\" ;\r\n                 sh:resultPath                 ex:ssn ;\r\n                 sh:resultSeverity             sh:Violation ;\r\n                 sh:sourceConstraintComponent  sh:MaxCountConstraintComponent ;\r\n                 sh:sourceShape                _:b0\r\n               ]\r\n] ."
}
