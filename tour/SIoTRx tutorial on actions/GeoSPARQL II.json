{
    "builder": "SIoTRxBuilder",
    "description": "## Theory\r\nGeoSPARQL extends the SPARQL syntax with a set of functions that allow operations on\/between geometries. Part of them are described starting from section 8.9 of the [OGC GeoSPARQL specification](https:\/\/opengeospatial.github.io\/ogc-geosparql\/geosparql11\/spec.pdf).\r\n\r\nNevertheless, we are going to focus on the functions that Apache Jena provides. The most commonly used are Filter functions that are available in the `http:\/\/jena.apache.org\/function\/spatial#` namespace. For example, the ***distance*** function can be used to obtain the distance between two diferent Geometry Literals in the specified unit. Moreover, the ***nearby*** function can simplify the syntax of a distance-based filter.\r\n```\r\nspatialF:distance(?x, ?y, units:kilometer)\r\n\r\nspatialF:nearby(?x, ?y, 500 units:kilometer)\r\n```\r\n\r\nIn some cases, simpler queries can be done using Property Functions instead of Filter Functions, but note that these require a Spatial Index to be setup for the dataset. \r\n\r\nTo learn more about these functions visit the [Apache Jena documentation](https:\/\/jena.apache.org\/documentation\/geosparql\/#geometry-property-filter-functions).\r\n## Hands-on\r\n### Task\r\nComplete the SPARQL query in order to retrieve the URI and distance from places in a radius of 1250 kilometers from Oneonta.",
    "user_template": "<#-- RDF DATA -->\r\n<#assign rdf>\r\n@prefix geo: <http:\/\/www.opengis.net\/ont\/geosparql#> .\r\n\r\n<http:\/\/sample.com\/resource\/feature\/Oneonta> a geo:Feature;\r\n\t<http:\/\/xmlns.com\/foaf\/0.1\/name> \"Oneonta\" ;\r\n\tgeo:hasGeometry <http:\/\/sample.com\/resource\/geometry\/Oneonta> .\r\n\r\n<http:\/\/sample.com\/resource\/geometry\/Oneonta> a geo:Geometry;\r\n\tgeo:asWKT \"POINT(-74.4168577 44.9625428)\"^^geo:wktLiteral .\r\n\r\n<http:\/\/sample.com\/resource\/feature\/Iowa> a geo:Feature;\r\n\t<http:\/\/xmlns.com\/foaf\/0.1\/name> \"Iowa\" ;\r\n\tgeo:hasGeometry <http:\/\/sample.com\/resource\/geometry\/Iowa> .\r\n\r\n<http:\/\/sample.com\/resource\/geometry\/Iowa> a geo:Geometry;\r\n\tgeo:asWKT \"POINT(-82.319746 29.6862705)\"^^geo:wktLiteral .\r\n\r\n<http:\/\/sample.com\/resource\/feature\/Alberta> a geo:Feature;\r\n\t<http:\/\/xmlns.com\/foaf\/0.1\/name> \"Alberta\" ;\r\n\tgeo:hasGeometry <http:\/\/sample.com\/resource\/geometry\/Alberta> .\r\n\r\n<http:\/\/sample.com\/resource\/geometry\/Alberta> a geo:Geometry;\r\n\tgeo:asWKT \"POINT(-76.4098259 41.0816094)\"^^geo:wktLiteral .\r\n\r\n<http:\/\/sample.com\/resource\/feature\/Bock> a geo:Feature;\r\n\t<http:\/\/xmlns.com\/foaf\/0.1\/name> \"Bock\" ;\r\n\tgeo:hasGeometry <http:\/\/sample.com\/resource\/geometry\/Bock> .\r\n\r\n<http:\/\/sample.com\/resource\/geometry\/Bock> a geo:Geometry;\r\n\tgeo:asWKT \"POINT(-85.9562663 41.6908535)\"^^geo:wktLiteral .\r\n\r\n<http:\/\/sample.com\/resource\/feature\/Elmhurst> a geo:Feature;\r\n\t<http:\/\/xmlns.com\/foaf\/0.1\/name> \"Elmhurst\" ;\r\n\tgeo:hasGeometry <http:\/\/sample.com\/resource\/geometry\/Elmhurst> .\r\n\r\n<http:\/\/sample.com\/resource\/geometry\/Elmhurst> a geo:Geometry;\r\n\tgeo:asWKT \"POINT(-109.9103821 31.4199205)\"^^geo:wktLiteral .\r\n<\/#assign>\r\n\r\n<#-- COMPLETE THE QUERY BELOW -->\r\n<#assign query>\r\n\tPREFIX rdfs: <http:\/\/www.w3.org\/2000\/01\/rdf-schema#>\r\n\tPREFIX spatialF: <http:\/\/jena.apache.org\/function\/spatial#> \r\n\tPREFIX units: <http:\/\/www.opengis.net\/def\/uom\/OGC\/1.0\/>\r\n\tPREFIX foaf: <http:\/\/xmlns.com\/foaf\/0.1\/>\r\n\tPREFIX geo: <http:\/\/www.opengis.net\/ont\/geosparql#>\r\n\r\n\tSELECT ?point ?distance WHERE {\r\n\t\t\r\n\t}\r\n<\/#assign>\r\n\r\n<#assign config = '{\"query\" : \"'+query+'\", \"data-forma\" : \"rdf\/xml\" }'>\r\n<@action type=\"SparqlEngine\" data=rdf conf=config; result>\r\n[=result]\r\n<\/@action>",
    "solution_template": "<#-- RDF DATA -->\r\n<#assign rdf>\r\n@prefix geo: <http:\/\/www.opengis.net\/ont\/geosparql#> .\r\n\r\n<http:\/\/sample.com\/resource\/feature\/Oneonta> a geo:Feature;\r\n\t<http:\/\/xmlns.com\/foaf\/0.1\/name> \"Oneonta\" ;\r\n\tgeo:hasGeometry <http:\/\/sample.com\/resource\/geometry\/Oneonta> .\r\n\r\n<http:\/\/sample.com\/resource\/geometry\/Oneonta> a geo:Geometry;\r\n\tgeo:asWKT \"POINT(-74.4168577 44.9625428)\"^^geo:wktLiteral .\r\n\r\n<http:\/\/sample.com\/resource\/feature\/Iowa> a geo:Feature;\r\n\t<http:\/\/xmlns.com\/foaf\/0.1\/name> \"Iowa\" ;\r\n\tgeo:hasGeometry <http:\/\/sample.com\/resource\/geometry\/Iowa> .\r\n\r\n<http:\/\/sample.com\/resource\/geometry\/Iowa> a geo:Geometry;\r\n\tgeo:asWKT \"POINT(-82.319746 29.6862705)\"^^geo:wktLiteral .\r\n\r\n<http:\/\/sample.com\/resource\/feature\/Alberta> a geo:Feature;\r\n\t<http:\/\/xmlns.com\/foaf\/0.1\/name> \"Alberta\" ;\r\n\tgeo:hasGeometry <http:\/\/sample.com\/resource\/geometry\/Alberta> .\r\n\r\n<http:\/\/sample.com\/resource\/geometry\/Alberta> a geo:Geometry;\r\n\tgeo:asWKT \"POINT(-76.4098259 41.0816094)\"^^geo:wktLiteral .\r\n\r\n<http:\/\/sample.com\/resource\/feature\/Bock> a geo:Feature;\r\n\t<http:\/\/xmlns.com\/foaf\/0.1\/name> \"Bock\" ;\r\n\tgeo:hasGeometry <http:\/\/sample.com\/resource\/geometry\/Bock> .\r\n\r\n<http:\/\/sample.com\/resource\/geometry\/Bock> a geo:Geometry;\r\n\tgeo:asWKT \"POINT(-85.9562663 41.6908535)\"^^geo:wktLiteral .\r\n\r\n<http:\/\/sample.com\/resource\/feature\/Elmhurst> a geo:Feature;\r\n\t<http:\/\/xmlns.com\/foaf\/0.1\/name> \"Elmhurst\" ;\r\n\tgeo:hasGeometry <http:\/\/sample.com\/resource\/geometry\/Elmhurst> .\r\n\r\n<http:\/\/sample.com\/resource\/geometry\/Elmhurst> a geo:Geometry;\r\n\tgeo:asWKT \"POINT(-109.9103821 31.4199205)\"^^geo:wktLiteral .\r\n<\/#assign>\r\n\r\n<#-- COMPLETE THE QUERY BELOW -->\r\n<#assign query>\r\n\tPREFIX rdfs: <http:\/\/www.w3.org\/2000\/01\/rdf-schema#>\r\n\tPREFIX spatialF: <http:\/\/jena.apache.org\/function\/spatial#> \r\n\tPREFIX units: <http:\/\/www.opengis.net\/def\/uom\/OGC\/1.0\/>\r\n\tPREFIX foaf: <http:\/\/xmlns.com\/foaf\/0.1\/>\r\n\tPREFIX geo: <http:\/\/www.opengis.net\/ont\/geosparql#>\r\n\r\n\tSELECT ?point ?distance WHERE {\r\n\t\t?center a geo:Feature .\r\n\t\t?center foaf:name \\\"Oneonta\\\" .\r\n\t\t?center geo:hasGeometry ?geom .\r\n\t\t?geom geo:asWKT ?g .\r\n\t\t?point a geo:Feature .\r\n\t\tFILTER(?center != ?point) .\r\n\t\t?point geo:hasGeometry ?geomP .\r\n\t\t?geomP geo:asWKT ?gP .\r\n\t \tBIND( spatialF:distance(?g, ?gP, units:kilometer) as ?distance) .\r\n\t \tFILTER(?distance < 1250)\r\n\t}\r\n<\/#assign>\r\n\r\n<#assign config = '{\"query\" : \"'+query+'\", \"data-forma\" : \"rdf\/xml\" }'>\r\n<@action type=\"SparqlEngine\" data=rdf conf=config; result>\r\n[=result]\r\n<\/@action>",
    "expected_result": "{ \"head\": {\r\n    \"vars\": [ \"point\" , \"distance\" ]\r\n  } ,\r\n  \"results\": {\r\n    \"bindings\": [\r\n      { \r\n        \"point\": { \"type\": \"uri\" , \"value\": \"http:\/\/sample.com\/resource\/feature\/Bock\" } ,\r\n        \"distance\": { \"type\": \"literal\" , \"datatype\": \"http:\/\/www.w3.org\/2001\/XMLSchema#double\" , \"value\": \"1000.675293e0\" }\r\n      } ,\r\n      { \r\n        \"point\": { \"type\": \"uri\" , \"value\": \"http:\/\/sample.com\/resource\/feature\/Alberta\" } ,\r\n        \"distance\": { \"type\": \"literal\" , \"datatype\": \"http:\/\/www.w3.org\/2001\/XMLSchema#double\" , \"value\": \"460.911039e0\" }\r\n      }\r\n    ]\r\n  }\r\n}"
  }