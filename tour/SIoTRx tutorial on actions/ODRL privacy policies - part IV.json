{
    "description": "This mapping has an ODRL privacy policy and the user can (or cant) have access to the data. Depending if the value provided by a IoT device (a person counter) is over 0.",
    "user_template": "<#assign counterConf=providers(\"HttpProvider\", { \"method\" : \"GET\", \"url\" : \"https://helio-dev.data.linkeddata.es/api/upm-person-counting/data\"})>\r\n<#assign counterConf= counterConf?eval>\r\n<#assign counterValue=counterConf.measures[0].value>\r\n\r\n<#assign policy>\r\n{\r\n \"@context\": \"http://www.w3.org/ns/odrl.jsonld\",\r\n \"@type\": \"Set\",\r\n \"uid\": \"http://example.com/policy:1010\",\r\n \"permission\": [{\r\n \t\"target\": \"https://helio-dev.data.linkeddata.es/api/upm-sensors/data\",\r\n\t\"action\": \"read\",\r\n\t\"constraint\": [{\r\n           \"leftOperand\":  { \r\n                \"@value\": \"[=counterValue]\", \r\n                \"@type\": \"xsd:integer\" \r\n                },\r\n           \"operator\": \"gt\",\r\n           \"rightOperand\":  { \r\n                \"@value\": \"0\", \r\n                \"@type\": \"xsd:integer\" \r\n                }\r\n       },{\r\n           \"leftOperand\":  { \r\n                \"@value\": \"[=.now?time?iso(\"Europe/Rome\")?replace('\\\\+.*','', 'r')]\", \r\n                \"@type\": \"xsd:time\" \r\n                },\r\n           \"operator\": \"lt\",\r\n           \"rightOperand\":  { \r\n                \"@value\": \"18:00:00\", \r\n                \"@type\": \"xsd:time\" \r\n                }\r\n       }  ]\r\n }]\r\n}\r\n</#assign>\r\n\r\n<@action type = \"ODRL\" data=policy; result>\r\n[=result]\r\n</@action>",
    "solution_template": "<#assign counterConf=providers(\"HttpProvider\", { \"method\" : \"GET\", \"url\" : \"https://helio-dev.data.linkeddata.es/api/upm-person-counting/data\"})>\r\n<#assign counterConf= counterConf?eval>\r\n<#assign counterValue=counterConf.measures[0].value>\r\n\r\n<#assign policy>\r\n{\r\n \"@context\": \"http://www.w3.org/ns/odrl.jsonld\",\r\n \"@type\": \"Set\",\r\n \"uid\": \"http://example.com/policy:1010\",\r\n \"permission\": [{\r\n \t\"target\": \"https://helio-dev.data.linkeddata.es/api/upm-sensors/data\",\r\n\t\"action\": \"read\",\r\n\t\"constraint\": [{\r\n           \"leftOperand\":  { \r\n                \"@value\": \"[=counterValue]\", \r\n                \"@type\": \"xsd:integer\" \r\n                },\r\n           \"operator\": \"gt\",\r\n           \"rightOperand\":  { \r\n                \"@value\": \"0\", \r\n                \"@type\": \"xsd:integer\" \r\n                }\r\n       },{\r\n           \"leftOperand\":  { \r\n                \"@value\": \"[=.now?time?iso(\"Europe/Rome\")?replace('\\\\+.*','', 'r')]\", \r\n                \"@type\": \"xsd:time\" \r\n                },\r\n           \"operator\": \"lt\",\r\n           \"rightOperand\":  { \r\n                \"@value\": \"18:00:00\", \r\n                \"@type\": \"xsd:time\" \r\n                }\r\n       }  ]\r\n }]\r\n}\r\n</#assign>\r\n\r\n<@action type = \"ODRL\" data=policy; result>\r\n[=result]\r\n</@action>",
    "expected_result": "{}"
}
