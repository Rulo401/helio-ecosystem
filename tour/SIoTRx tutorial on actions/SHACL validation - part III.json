{
  "builder": "SIoTRxBuilder",
  "description": "## SHACL validation part III\n### This mapping shows how to use the [SHACL validator action](https://github.com/helio-ecosystem/helio-action-shacl-validator) when the [RDF data](https://raw.githubusercontent.com/helio-ecosystem/helio-ecosystem/main/resources/siotrx/actions/shacl/sample-dataset.ttl) and the [SHACL shape](https://raw.githubusercontent.com/helio-ecosystem/helio-ecosystem/main/resources/siotrx/actions/shacl/sample-shacl.ttl) are expressed in a different serialization of `TURTLE`. In these cases, the configuration of the action must specify their format using the keys `shape-format` and `data-format` respectively. In addition, the report output serialisation can be changed using the key `output-format`. In this example the RDF data is expressed in `RDF/XML`, the shape in `N3`, and the output is `JSON-LD`. The possible values to be used in the three cases are: `turtle`, `ttl`, `json-ld`, `json-ld-11`, `n3`, `n-triples`, `nt`, `rdf/xml`.",
  "user_template": "<#-- RDF data & SHACL shape-->\r\n<#assign rdf=\"https:\/\/raw.githubusercontent.com\/helio-ecosystem\/helio-ecosystem\/main\/resources\/siotrx\/actions\/shacl\/sample-dataset.rdf\">\r\n<#assign shape=\"https:\/\/raw.githubusercontent.com\/helio-ecosystem\/helio-ecosystem\/main\/resources\/siotrx\/actions\/shacl\/sample-shacl.n3\">\r\n\r\n<#-- Setting up the input and output serializations -->\r\n<#assign config='{\"shape\" : \"'+shape+'\", \"shape-format\" : \"n3\", \"data-format\" : \"rdf\/xml\", \"output-format\" : \"json-ld\" }'>\r\n\r\n<#-- Running the validation -->\r\n<@action type=\"ShaclValidator\" data=rdf conf=config; report>\r\n[=report]\r\n<\/@action>",
  "solution_template": "<#-- RDF data & SHACL shape-->\r\n<#assign rdf=\"https:\/\/raw.githubusercontent.com\/helio-ecosystem\/helio-ecosystem\/main\/resources\/siotrx\/actions\/shacl\/sample-dataset.rdf\">\r\n<#assign shape=\"https:\/\/raw.githubusercontent.com\/helio-ecosystem\/helio-ecosystem\/main\/resources\/siotrx\/actions\/shacl\/sample-shacl.n3\">\r\n\r\n<#-- Setting up the input and output serializations -->\r\n<#assign config='{\"shape\" : \"'+shape+'\", \"shape-format\" : \"n3\", \"data-format\" : \"rdf\/xml\", \"output-format\" : \"json-ld\" }'>\r\n\r\n<#-- Running the validation -->\r\n<@action type=\"ShaclValidator\" data=rdf conf=config; report>\r\n[=report]\r\n<\/@action>",
  "expected_result": "{\r\n  \"@graph\" : [ {\r\n    \"@id\" : \"_:b0\",\r\n    \"@type\" : \"sh:ValidationResult\",\r\n    \"focusNode\" : \"ns0:Bob\",\r\n    \"resultMessage\" : \"Pattern[^\\\\\\\\d{3}-\\\\\\\\d{2}-\\\\\\\\d{4}$]: Does not match: '123-45-6789'\",\r\n    \"resultPath\" : \"ns0:ssn\",\r\n    \"resultSeverity\" : \"sh:Violation\",\r\n    \"sourceConstraintComponent\" : \"sh:PatternConstraintComponent\",\r\n    \"sourceShape\" : \"_:b1\",\r\n    \"value\" : \"123-45-6789\"\r\n  }, {\r\n    \"@id\" : \"_:b2\",\r\n    \"@type\" : \"sh:ValidationResult\",\r\n    \"focusNode\" : \"ns0:Calvin\",\r\n    \"resultMessage\" : \"ClassConstraint[<https:\/\/sample.es\/resources\/Company>]: Expected class :<https:\/\/sample.es\/resources\/Company> for <https:\/\/sample.es\/resources\/UntypedCompany>\",\r\n    \"resultPath\" : \"ns0:worksFor\",\r\n    \"resultSeverity\" : \"sh:Violation\",\r\n    \"sourceConstraintComponent\" : \"sh:ClassConstraintComponent\",\r\n    \"sourceShape\" : \"_:b3\",\r\n    \"value\" : {\r\n      \"@id\" : \"ns0:UntypedCompany\"\r\n    }\r\n  }, {\r\n    \"@id\" : \"_:b4\",\r\n    \"@type\" : \"sh:ValidationReport\",\r\n    \"sh:conforms\" : false,\r\n    \"result\" : [ \"_:b2\", \"_:b5\", \"_:b6\", \"_:b7\", \"_:b8\", \"_:b0\" ]\r\n  }, {\r\n    \"@id\" : \"_:b5\",\r\n    \"@type\" : \"sh:ValidationResult\",\r\n    \"focusNode\" : \"ns0:Calvin\",\r\n    \"resultMessage\" : \"Closed[https:\/\/sample.es\/resources\/ssn, https:\/\/sample.es\/resources\/worksFor][http:\/\/www.w3.org\/1999\/02\/22-rdf-syntax-ns#type] Property = <https:\/\/sample.es\/resources\/birthDate> : Object = \\\"1971-07-07\\\"^^xsd:date\",\r\n    \"resultPath\" : \"ns0:birthDate\",\r\n    \"resultSeverity\" : \"sh:Violation\",\r\n    \"sourceConstraintComponent\" : \"sh:ClosedConstraintComponent\",\r\n    \"sourceShape\" : \"ns0:PersonShape\",\r\n    \"value\" : {\r\n      \"@type\" : \"xsd:date\",\r\n      \"@value\" : \"1971-07-07\"\r\n    }\r\n  }, {\r\n    \"@id\" : \"_:b6\",\r\n    \"@type\" : \"sh:ValidationResult\",\r\n    \"focusNode\" : \"ns0:Alice\",\r\n    \"resultMessage\" : \"Pattern[^\\\\\\\\d{3}-\\\\\\\\d{2}-\\\\\\\\d{4}$]: Does not match: '987-65-432A'\",\r\n    \"resultPath\" : \"ns0:ssn\",\r\n    \"resultSeverity\" : \"sh:Violation\",\r\n    \"sourceConstraintComponent\" : \"sh:PatternConstraintComponent\",\r\n    \"sourceShape\" : \"_:b1\",\r\n    \"value\" : \"987-65-432A\"\r\n  }, {\r\n    \"@id\" : \"_:b7\",\r\n    \"@type\" : \"sh:ValidationResult\",\r\n    \"focusNode\" : \"ns0:Bob\",\r\n    \"resultMessage\" : \"maxCount[1]: Invalid cardinality: expected max 1: Got count = 2\",\r\n    \"resultPath\" : \"ns0:ssn\",\r\n    \"resultSeverity\" : \"sh:Violation\",\r\n    \"sourceConstraintComponent\" : \"sh:MaxCountConstraintComponent\",\r\n    \"sourceShape\" : \"_:b1\"\r\n  }, {\r\n    \"@id\" : \"_:b8\",\r\n    \"@type\" : \"sh:ValidationResult\",\r\n    \"focusNode\" : \"ns0:Bob\",\r\n    \"resultMessage\" : \"Pattern[^\\\\\\\\d{3}-\\\\\\\\d{2}-\\\\\\\\d{4}$]: Does not match: '124-35-6789'\",\r\n    \"resultPath\" : \"ns0:ssn\",\r\n    \"resultSeverity\" : \"sh:Violation\",\r\n    \"sourceConstraintComponent\" : \"sh:PatternConstraintComponent\",\r\n    \"sourceShape\" : \"_:b1\",\r\n    \"value\" : \"124-35-6789\"\r\n  } ],\r\n  \"@context\" : {\r\n    \"value\" : {\r\n      \"@id\" : \"http:\/\/www.w3.org\/ns\/shacl#value\"\r\n    },\r\n    \"resultPath\" : {\r\n      \"@id\" : \"http:\/\/www.w3.org\/ns\/shacl#resultPath\",\r\n      \"@type\" : \"@id\"\r\n    },\r\n    \"sourceShape\" : {\r\n      \"@id\" : \"http:\/\/www.w3.org\/ns\/shacl#sourceShape\",\r\n      \"@type\" : \"@id\"\r\n    },\r\n    \"resultMessage\" : {\r\n      \"@id\" : \"http:\/\/www.w3.org\/ns\/shacl#resultMessage\"\r\n    },\r\n    \"sourceConstraintComponent\" : {\r\n      \"@id\" : \"http:\/\/www.w3.org\/ns\/shacl#sourceConstraintComponent\",\r\n      \"@type\" : \"@id\"\r\n    },\r\n    \"resultSeverity\" : {\r\n      \"@id\" : \"http:\/\/www.w3.org\/ns\/shacl#resultSeverity\",\r\n      \"@type\" : \"@id\"\r\n    },\r\n    \"focusNode\" : {\r\n      \"@id\" : \"http:\/\/www.w3.org\/ns\/shacl#focusNode\",\r\n      \"@type\" : \"@id\"\r\n    },\r\n    \"conforms\" : {\r\n      \"@id\" : \"http:\/\/www.w3.org\/ns\/shacl#conforms\",\r\n      \"@type\" : \"http:\/\/www.w3.org\/2001\/XMLSchema#boolean\"\r\n    },\r\n    \"result\" : {\r\n      \"@id\" : \"http:\/\/www.w3.org\/ns\/shacl#result\",\r\n      \"@type\" : \"@id\"\r\n    },\r\n    \"rdf\" : \"http:\/\/www.w3.org\/1999\/02\/22-rdf-syntax-ns#\",\r\n    \"sh\" : \"http:\/\/www.w3.org\/ns\/shacl#\",\r\n    \"xsd\" : \"http:\/\/www.w3.org\/2001\/XMLSchema#\",\r\n    \"rdfs\" : \"http:\/\/www.w3.org\/2000\/01\/rdf-schema#\",\r\n    \"ns0\" : \"https:\/\/sample.es\/resources\/\"\r\n  }\r\n}"
}
